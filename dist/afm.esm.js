function e(e){return e.replace(/[\-\[\]{}()*+?.,\\\^\$|#]/g,"\\$&")}function r(r="",t="extension",n=((e="")=>e),s={},c={}){const i=r.includes("\r"),o=i?"\r\n":"\n",l=r.match(/[^>]\s*?`{3,3}[^`]+`{3,3}(\r?\n)?/g)||[],a=Array.from(new Set(r.match(/\&#\w+;/g)||[])),p=a.map((e=>escape(e))),$=l.reduce(((e,r)=>e.replace(r,"")),r),d=a.reduce(((e,r)=>e.replace(r,escape(r))),$).match(/(\s+|\t+)?\>\[\!.*\r?\n((\s+|\t+)?\>(?!\[\!).*\r?\n?){1,}/g)||[],f=Object.keys(s).filter((e=>"VIDEO"===s[e]))[0]||"VIDEO",m=new RegExp(`(?<!\`\`\`\\r?\\n(\\s+|\\t+)?)\\>\\[\\!${f}\\]\\((.*)\\)`,"g");let g=r;for(const r of d){const l=r.split(i?/\r\n/:/\n/).filter((e=>e.length>0&&/[^\s]+/.test(e))),p=(l[0].match(/\>\[\!(.*)\]/)||[])[1]||"",$=l[0].replace(/\>\[.*/,""),d=`${o}${$}`,f=n(l.slice(1,l.length).map((r=>{let t=r.replace(/^(\s+|\t+)?\>/,"").trim();for(const r of a)t.includes(r)&&(t=t.replace(new RegExp(e(r),"g"),escape(r)));return t})).filter(((e,r)=>0!==r||e.length>0)).join(o).trim()).split(o).map((e=>`${$}${e}`)).join(o),m=(p in s?s[p]:p).toLowerCase().replace(/\s/g,"");g=g.replace(l.join(o),`${$}<div class="${t} ${m}">${d}<div>${p in c?c[p]:p}</div>${d}<div>${o}${f}${d}</div>${d}</div>${o}`)}g=g.replace(m,`<div class="${t} video"><iframe allowfullscreen embedded-video src="$2" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"><source src="$2" type="" /><p>Your browser does not support the iframe element.</p></iframe></div>`);for(const r of p)g=g.replace(new RegExp(e(r),"g"),unescape(r));return g.trim()}export{r as afm};