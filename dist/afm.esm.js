function e(e){return e.replace(/[\-\[\]{}()*+?.,\\\^\$|#]/g,"\\$&")}function t(t="",r="extension",n=((e="")=>e),s={},i={}){const c=t.includes("\r"),o=c?"\r\n":"\n",l=t.match(/[^>]\s*?`{3,3}[^`]+`{3,3}(\r?\n)?/g)||[],p=Array.from(new Set(t.match(/\&#\w+;/g)||[])),a=p.map((e=>escape(e))),$=l.reduce(((e,t)=>e.replace(t,"")),t.toString()),d=p.reduce(((t,r)=>t.replace(new RegExp(e(r),"g"),escape(r))),$).match(/(?!\n)(\s+|\t+)?\>\[\!.*\r?\n((\s+|\t+)?\>(?!\[\!).*\r?\n?){1,}/g)||[],g=Object.keys(s).filter((e=>"VIDEO"===s[e]))[0]||"VIDEO",f=new RegExp(`(?<!\`\`\`\\r?\\n(\\s+|\\t+)?)\\>\\[\\!${g}\\]\\((.*)\\)`,"g");let m=t.toString();for(const t of d){const l=t.split(c?/\r\n/:/\n/).filter((e=>e.length>0&&/[^\s]+/.test(e))),$=(l[0].match(/\>\[\!(.*)\]/)||[])[1]||"",d=l[0].replace(/\>\[.*/,""),g=`${o}${d}`,f=n(l.slice(1,l.length).map((t=>{let r=t.replace(/^(\s+|\t+)?\>/,"").trim();for(const t of p)r.includes(t)&&(r=r.replace(new RegExp(e(t),"g"),escape(t)));return r})).filter(((e,t)=>0!==t||e.length>0)).join(o).trim()).split(o).map((e=>`${d}${e}`)).join(o),u=($ in s?s[$]:$).toLowerCase().replace(/\s/g,""),h=l.map((t=>{let r=t;for(const t of a)r.includes(t)&&(r=r.replace(new RegExp(e(t),"g"),unescape(t)));return r})).join(o);m=m.replace(h,`${d}<div class="${r} ${u}">${g}<div>${$ in i?i[$]:$}</div>${g}<div>${o}${f}${g}</div>${g}</div>${o}`)}return m=m.replace(f,`<div class="${r} video"><iframe allowfullscreen embedded-video src="$2" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"><source src="$2" type="" /><p>Your browser does not support the iframe element.</p></iframe></div>`),m.trim()}export{t as afm};