!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).afm={})}(this,(function(e){"use strict";function t(e){return JSON.parse(JSON.stringify(e))}function n(e){return e.replace(/[\-\[\]{}()*+?.,\\\^\$|#]/g,"\\$&")}e.afm=function(e="",r="extension",s=((e="")=>e),i={},o={}){const c=e.includes("\r")?"\r\n":"\n",l=e.match(/(?<!\\|\>\s*)```[^```]+\\?```(\r?\n)?/g)||[],p=Array.from(new Set(e.match(/\&#\w+;/g)||[])),a=p.map((e=>escape(e))),f=l.reduce(((e,t)=>e.replace(t,"")),t(e)),d=p.reduce(((e,t)=>e.replace(new RegExp(n(t),"g"),escape(t))),f).match(/(?!\r?\n)(\s+|\t+)?\>\[\!.*\r?\n((\s+|\t+)?\>(?!\[\!).*\r?\n?){1,}/g)||[],u=Object.keys(i).filter((e=>"VIDEO"===i[e]))[0]||"VIDEO",g=new RegExp(`(?<!\`\`\`\\r?\\n(\\s+|\\t+)?)\\>\\[\\!${u}\\]\\((.*)\\)`,"g");let $=t(e);for(const e of d){const t=e.split(/\r?\n/).filter((e=>e.length>0&&/[^\s]+/.test(e))),l=(t[0].match(/\>\[\!(.*)\]/)||[])[1]||"",f=t[0].replace(/\>\[.*/,""),d=`${c}${f}`,u=`${f}${s(t.slice(1,t.length).map((e=>{let t=e.replace(/^(\s+|\t+)?\>/,"").trim();for(const e of p)t.includes(e)&&(t=t.replace(new RegExp(n(e),"g"),escape(e)));return t})).filter(((e,t)=>0!==t||e.length>0)).join(c).trim()).split(/\r?\n/).join(d)}`,g=(l in i?i[l]:l).toLowerCase().replace(/\s/g,""),m=t.map((e=>{let t=e;for(const e of a)t.includes(e)&&(t=t.replace(new RegExp(n(e),"g"),unescape(e)));return t})).join(c);$=$.replace(m,`${f}<div class="${r} ${g}">${d}<div>${l in o?o[l]:l}</div>${d}<div>${c}${u.replace(/\r?\n$/,"")}${d}</div>${d}</div>`)}$=$.replace(g,`<div class="${r} video"><iframe allowfullscreen embedded-video src="$2" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"><source src="$2" type="" /><p>Your browser does not support the iframe element.</p></iframe></div>`);for(const e of a)$=$.replace(new RegExp(n(e),"g"),unescape(e));return $.trim()},Object.defineProperty(e,"__esModule",{value:!0})}));